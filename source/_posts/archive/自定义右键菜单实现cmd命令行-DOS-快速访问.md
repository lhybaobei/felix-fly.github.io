---
title: 自定义右键菜单实现cmd命令行(DOS)快速访问
tags:
  - cmd
  - 右键菜单
  - 命令行
  - 注册表
url: 730.html
id: 730
categories:
  - 电脑医生
date: 2010-09-24 20:57:03
---

平时打开命令行一般都是在开始-运行中，打开cmd实现，但是这样打开的命令行有一个小小的不便，就是当前的工作目录默认是在用户配置的目录，虽然可以更改为其它目录，不过每次打开cmd都是同样的工作目录，使用起来有些不方便。  

最好的目标是在资源管理器中，在什么目录打开cmd工作目录就在当前目录，比如说打开我的电脑-D盘-abc目录-123子目录，通过右键菜单打开cmd命令行窗口，工作目录为D:\\abc\\123，这样在使用svn等命令时就方便多了，不需要cd切换目录了。  

实现此功能的代码倒是不很复杂，通过注册表就能实现了，代码如下：  

```REG  

Windows Registry Editor Version 5.00  

\[HKEY\_CLASSES\_ROOT\\*\\shell\\cmdhere\] @="命令行(&K)"  

\[HKEY\_CLASSES\_ROOT\\*\\shell\\cmdhere\\command\] @=hex(2):25,00,43,00,6f,00,6d,00,53,00,70,00,65,00,63,00,25,00,00,00  

\[HKEY\_CLASSES\_ROOT\\Directory\\shell\\cmdhere\] @="命令行(&K)"  

\[HKEY\_CLASSES\_ROOT\\Directory\\shell\\cmdhere\\command\] @=hex(2):25,00,43,00,6f,00,6d,00,53,00,70,00,65,00,63,00,25,00,00,00 \\n```  

其中的

@="命令行(&K)"

可以自己定义，

&

连接字母可以实现快捷键的功能，不过要避免与其它快捷键冲突。  

中间两行是增加所有文件的右键菜单，最后两行是在文件夹右键菜单中添加项目。